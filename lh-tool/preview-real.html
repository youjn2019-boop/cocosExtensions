<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LH Tool é¢æ¿é¢„è§ˆï¼ˆDist æ‰“åŒ…ç‰ˆæœ¬ï¼‰</title>
    <style id="base-style">
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #999;
            font-size: 14px;
            z-index: 1000;
        }
        .info-banner {
            background: #2d5016;
            color: #a9dc76;
            padding: 8px 16px;
            font-size: 12px;
            border-bottom: 1px solid #3a6b1f;
        }
        .bundle-info {
            background: #1a1a1a;
            color: #999;
            padding: 12px 16px;
            font-size: 11px;
            border-bottom: 1px solid #333;
            font-family: 'Consolas', monospace;
        }
        .bundle-info div {
            margin: 4px 0;
        }
        .bundle-info .label {
            color: #666;
            display: inline-block;
            width: 150px;
        }
        .bundle-info .value {
            color: #a9dc76;
        }
    </style>
    <style id="panel-style"></style>
    <!-- å°è¯•å¤šä¸ª Vue 3 CDN æº -->
    <script>
        const vueCDNs = [
            'https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.prod.js',
            'https://unpkg.com/vue@3.3.4/dist/vue.global.prod.js',
            'https://cdn.bootcdn.net/ajax/libs/vue/3.3.4/vue.global.prod.js'
        ];
        
        let cdnIndex = 0;
        
        function loadVue() {
            if (cdnIndex >= vueCDNs.length) {
                console.error('æ‰€æœ‰ Vue CDN åŠ è½½å¤±è´¥');
                return;
            }
            
            const script = document.createElement('script');
            script.src = vueCDNs[cdnIndex];
            script.onload = () => console.log('Vue åŠ è½½æˆåŠŸ:', vueCDNs[cdnIndex]);
            script.onerror = () => {
                console.warn('CDN åŠ è½½å¤±è´¥:', vueCDNs[cdnIndex]);
                cdnIndex++;
                loadVue();
            };
            document.head.appendChild(script);
        }
        
        loadVue();
    </script>
</head>
<body>
    <div id="loading">åŠ è½½ä¸­...</div>
    <div class="info-banner">
        âœ… é¢„è§ˆæ¨¡å¼ï¼šä½¿ç”¨ static æ¨¡æ¿æ–‡ä»¶ï¼ˆä¸ dist æ‰“åŒ…ä»£ç ä¸­ä½¿ç”¨çš„ç›¸åŒï¼‰
    </div>
    <div class="bundle-info">
        <div><span class="label">HTML æ¨¡æ¿:</span> <span class="value">static/template/default/index.html</span></div>
        <div><span class="label">CSS æ ·å¼:</span> <span class="value">static/style/default/index.css</span></div>
        <div><span class="label">æ‰“åŒ…ä»£ç :</span> <span class="value">dist/panels/default/index.js (1.9 MB - å« Vue + fs-extra)</span></div>
        <div><span class="label">è¯´æ˜:</span> <span class="value">æ‰“åŒ…åçš„ä»£ç ä¼šåœ¨è¿è¡Œæ—¶è¯»å– static æ–‡ä»¶ï¼Œæ­¤é¢„è§ˆä½¿ç”¨ç›¸åŒçš„æ–‡ä»¶</span></div>
    </div>
    <div id="app-container"></div>

    <script>
        // åŠ¨æ€åŠ è½½ HTML å’Œ CSS
        Promise.all([
            fetch('./static/template/default/index.html').then(r => r.text()),
            fetch('./static/style/default/index.css').then(r => r.text())
        ]).then(([html, css]) => {
            // åŠ è½½ CSS
            document.getElementById('panel-style').textContent = css;
            console.log('âœ… CSS åŠ è½½å®Œæˆ');
            
            // åŠ è½½ HTML
            document.getElementById('app-container').innerHTML = html;
            console.log('âœ… HTML åŠ è½½å®Œæˆ');
            
            // ç­‰å¾… Vue åŠ è½½ååˆå§‹åŒ–
            initApp();
        }).catch(err => {
            console.error('âŒ åŠ è½½å¤±è´¥:', err);
            document.getElementById('loading').textContent = 'åŠ è½½å¤±è´¥: ' + err.message;
        });

        // ç­‰å¾… Vue åŠ è½½
        function initApp() {
            if (typeof Vue === 'undefined') {
                setTimeout(initApp, 100);
                return;
            }
            
            console.log('âœ… Vue åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆ›å»ºåº”ç”¨');
            createVueApp();
        }
        
        function createVueApp() {
            const { createApp } = Vue;
            
            // åˆ›å»º Vue åº”ç”¨ï¼ˆæ¨¡æ‹Ÿ dist ä¸­çš„ä»£ç ï¼‰
            const app = createApp({
                data() {
                    return {
                        activeTab: 'table',
                        config: {
                            exeFile: 'D:\\tools\\TableTool.exe',
                            dataDir: 'D:\\project\\data',
                            codeDir: 'D:\\project\\code',
                            exportDataDir: 'D:\\project\\export',
                            langDir: 'E:\\output\\localize',
                            tempDir: 'E:\\temp',
                            exportMode: 'Client',
                            formatEnabled: true,
                            exportModes: ['Client', 'Battle']
                        }
                    };
                },
                
                methods: {
                    async selectFile(field, title) {
                        alert('é€‰æ‹©æ–‡ä»¶: ' + title + '\\n(å®é™…ä¼šæ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†)');
                        console.log('selectFile:', field, title);
                    },
                    
                    async selectDirectory(field, title) {
                        alert('é€‰æ‹©ç›®å½•: ' + title + '\\n(å®é™…ä¼šæ‰“å¼€ç›®å½•é€‰æ‹©å¯¹è¯æ¡†)');
                        console.log('selectDirectory:', field, title);
                    },
                    
                    saveConfig() {
                        console.log('ä¿å­˜é…ç½®:', this.config);
                    },
                    
                    async exportLocalize() {
                        console.log('å¯¼å‡ºå¤šè¯­è¨€');
                        alert('å¯¼å‡ºå¤šè¯­è¨€\\n\\né…ç½®:\\næ•°æ®ç›®å½•: ' + this.config.dataDir + '\\nå¯¼å‡ºç›®å½•: ' + this.config.langDir + '\\næ ¼å¼åŒ–: ' + (this.config.formatEnabled ? 'æ˜¯' : 'å¦') + '\\n\\nğŸ’¡ åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œæ­¤åŠŸèƒ½ä¼šè°ƒç”¨:\\ndist/table/export-localize.js\\n(å·²åŒ…å« xlsx ç­‰ä¾èµ–ï¼Œæ— éœ€ node_modules)');
                    },
                    
                    handleTableCopy() {
                        console.log('æ‰“è¡¨+å¤åˆ¶');
                        alert('æ‰“è¡¨+å¤åˆ¶\\n\\nğŸ’¡ åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œæ­¤åŠŸèƒ½ä¼šè°ƒç”¨:\\ndist/table/export-table.js\\n(å·²åŒ…å« iconv-liteã€fs-extra ç­‰ä¾èµ–)');
                    },
                    
                    handleTableCopyGen() {
                        console.log('æ‰“è¡¨+å¤åˆ¶+ç”ŸæˆtableMgr');
                        alert('æ‰“è¡¨+å¤åˆ¶+ç”ŸæˆtableMgr\\n\\nğŸ’¡ åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œä¼šè°ƒç”¨æ‰“åŒ…åçš„æ¨¡å—\\næ‰€æœ‰ä¾èµ–å·²å†…è”åˆ° dist ä¸­');
                    }
                }
            });
            
            // æŒ‚è½½åº”ç”¨åˆ° #app
            app.mount('#app');
            
            // éšè—åŠ è½½æç¤º
            setTimeout(() => {
                const loading = document.getElementById('loading');
                if (loading) loading.style.display = 'none';
            }, 100);
            
            console.log('âœ… Vue åº”ç”¨å·²æŒ‚è½½åˆ° #app');
        }
    </script>
</body>
</html>
